---
import Entry from "@components/Entry.astro";
import BaseLayout from "@layouts/BaseLayout.astro";
import type { EntryData } from "@scripts/types";
import { getCollection, render } from "astro:content";
const projects = (await getCollection("project")).sort((a, b) => {
    if (a.data.releaseDate < b.data.releaseDate) {
        return -1;
    } else if (a.data.releaseDate > b.data.releaseDate) {
        return 1;
    }
    return 0;
});
---

<BaseLayout pageTitle="My projects">
    <ul>
        {
            projects.map((project) => (
                <li>
                    <a href={project.data.id}>{project.data.title}</a>
                </li>
            ))
        }
    </ul>
    {
        projects.map(async (project) => {
            const { Content } = await render(project);
            const data: EntryData = {
                title: project.data.title,
                id: project.data.id,
                cover: project.data.cover,
                table: project.data.table,
            };

            return (
                <Entry data={data}>
                    <Content />
                </Entry>
            );
        })
    }
</BaseLayout>
